{ns     audit-log-viewer.viewer
 import #{zenbox
          audit}

 table-view
 {:zen/tags #{audit/table-layout}
  :columns
  [{:name "Date" :path [:occuredDateTime] :fallback "—"}
   {:name "Event" :path [:code :coding 0 :display]}
   {:name "Outcome" :path [:outcome :code :display]}
   {:name "User" :path [:agent 0 :who :display]}
   {:name "Patient" :path [:patient :reference] :fallback "—"}]

  :views
  [{:when [[[:category {} :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110114"]
           [[:code :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110122"]
           [[:outcome :code :system] "http://terminology.hl7.org/CodeSystem/audit-event-outcome"]
           [[:outcome :code :code] "4"]]
    :col  [{:path [:agent 0 :who :identifier :value] :name "User id"}
           {:path [:agent 0 :who :display] :name "User name"}
           {:path [:occuredDateTime] :name "Login attempt timestamp"}
           {:path [:outcome :code :display] :name "Login status"}
           {:path [:agent 1 :networkString] :name "Login device"}
           {:path [:source :observer :identifier :value] :name "Login attempt to / System"}
           {:path [:source :observer :display] :name "Login attempt to / Service"}]}

   {:when [[[:category {} :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110114"]
           [[:code :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110122"]
           [[:outcome :code :system] "http://terminology.hl7.org/CodeSystem/audit-event-outcome"]
           [[:outcome :code :code ] "0"]]
    :col [{:path [:agent 0 :who :identifier :value] :name "User id"}
          {:path [:agent 0 :who :display] :name "User"}
          {:path [:occuredDateTime] :name "Login timestamp"}
          {:path [:outcome :code :display] :name "Login status"}
          {:path [:agent 1 :networkString] :name "Login device"}
          {:path [:source :observer :identifier :value] :name "Login to / System"}
          {:path [:source :observer :display] :name "Login to / Service"}]}

   {:when [[[:category {} :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110114"]
           [[:code :coding {:system "http://dicom.nema.org/resources/ontology/DCM"} :code] "110123"]
           [[:outcome :code :system] "http://terminology.hl7.org/CodeSystem/audit-event-outcome"]
           [[:outcome :code :code ] "0"]]
    :col [{:path [:agent 0 :who :identifier :value] :name "User id"}
          {:path [:agent 0 :who :display] :name "User"}
          {:path [:occuredDateTime] :name "Logout timestamp"}
          {:path [:outcome :code :display] :name "Logout status"}
          {:path [:agent 1 :networkString] :name "Logout device"}
          {:path [:source :observer :identifier :value] :name "Logout from / System"}
          {:path [:source :observer :display] :name "Login from / Service"}]}

   ]}}
